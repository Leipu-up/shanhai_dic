<view class="modal-container" wx:if="{{showModal}}">
  <view class="modal-mask" bindtap="handleCancel"></view>
  
  <view class="modal-content">
    <!-- æ ‡é¢˜æ  -->
    <view class="modal-header">
      <text class="modal-title">{{isEdit ? 'ç¼–è¾‘æ’ç­' : 'æ–°å¢æ’ç­'}}</text>
      <text class="close-btn" bindtap="handleCancel">Ã—</text>
    </view>
    
    <scroll-view class="modal-body" scroll-y>
      <!-- å‘˜å·¥é€‰æ‹© -->
      <view class="form-section">
        <view class="section-title">é€‰æ‹©å‘˜å·¥</view>
        <view class="form-item">
          <text class="form-label required">å‘˜å·¥å§“å</text>
          <picker 
            mode="selector" 
            range="{{staffOptions}}"
            range-key="name"
            value="{{selectedStaffName}}"
            bindchange="onStaffChange"
            class="picker-input"
          >
            <view class="picker-text {{selectedStaffName ? '' : 'placeholder'}}">
              {{selectedStaffName ? selectedStaffName : 'è¯·é€‰æ‹©å‘˜å·¥'}}
            </view>
          </picker>
        </view>
      </view>
      
      <!-- æ’ç­ç±»å‹ -->
      <view class="form-section">
        <view class="section-title">æ’ç­ç±»å‹</view>
        
        <view class="form-item">
          <view class="schedule-type-options">
            <view 
              class="type-option {{scheduleType === 'å…¨å¤©ç­' ? 'active' : ''}}" 
              bindtap="setScheduleType" 
              data-type="å…¨å¤©ç­"
            >
              <text class="type-icon">ğŸ‘©â€ğŸ’¼</text>
              <text class="type-text">å…¨å¤©ç­</text>
            </view>
            <view 
              class="type-option {{scheduleType === 'ä¼‘æ¯' ? 'active' : ''}}" 
              bindtap="setScheduleType" 
              data-type="ä¼‘æ¯"
            >
              <text class="type-icon">ğŸ–ï¸</text>
              <text class="type-text">ä¼‘æ¯</text>
            </view>
          </view>
        </view>
      </view>
      
      <!-- æ—¥å†é€‰æ‹© -->
      <view class="form-section">
        <view class="section-title">
          <text>é€‰æ‹©æ—¥æœŸ</text>
          <text class="selected-count" wx:if="{{selectedDates.length > 0}}">
            å·²é€‰ {{selectedDates.length}}/6 å¤©
          </text>
        </view>
        
        <view class="calendar-container">
          <!-- æœˆä»½å¯¼èˆª -->
          <view class="calendar-header">
            <view class="nav-btn prev" bindtap="prevMonth">â€¹</view>
            <text class="current-month">{{currentYear}}å¹´{{currentMonth + 1}}æœˆ</text>
            <view class="nav-btn next" bindtap="nextMonth">â€º</view>
          </view>
          
          <!-- æ˜ŸæœŸæ ‡é¢˜ -->
          <view class="week-header">
            <view class="week-day" wx:for="{{weekDays}}" wx:key="index">{{item}}</view>
          </view>
          
          <!-- æ—¥æœŸç½‘æ ¼ -->
          <view class="date-grid">
            <!-- å¡«å……ç©ºç™½ -->
            <view class="date-cell empty" wx:for="{{firstDayOfMonth}}" wx:key="index"></view>
            
            <!-- æ—¥æœŸ -->
            <view 
              class="date-cell {{getDateClass(item)}}" 
              wx:for="{{daysInMonth}}" 
              wx:key="index"
              bindtap="selectDate"
              data-date="{{item.date}}"
            >
              <text class="date-text">{{item.day}}</text>
              <text class="date-status" wx:if="{{item.status}}">{{item.status}}</text>
            </view>
          </view>
        </view>
      </view>
      
      <!-- å·²é€‰æ—¥æœŸåˆ—è¡¨ -->
      <view class="form-section" wx:if="{{selectedDates.length > 0}}">
        <view class="section-title">å·²é€‰æ—¥æœŸ</view>
        
        <view class="selected-dates">
          <view 
            class="selected-date-item" 
            wx:for="{{selectedDates}}" 
            wx:key="index"
            bindtap="removeDate"
            data-index="{{index}}"
          >
            <text class="date-text">{{item}}</text>
            <text class="remove-btn">Ã—</text>
          </view>
        </view>
      </view>
    </scroll-view>
    
    <!-- åº•éƒ¨æŒ‰é’® -->
    <view class="modal-footer">
      <button class="btn-cancel" bindtap="handleCancel">å–æ¶ˆ</button>
      <button class="btn-confirm" bindtap="handleConfirm" disabled="{{!isFormValid}}">ç¡®è®¤ä¿å­˜</button>
    </view>
  </view>
</view>