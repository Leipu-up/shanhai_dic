<view class="modal-container" wx:if="{{showModal}}">
    <view class="modal-mask" bindtap="handleCancel"></view>

    <view class="modal-content">
        <!-- 标题栏 -->
        <view class="modal-header">
            <text class="modal-title">{{isView ? '查看员工' :(isEdit ? '编辑员工' : '新增员工')}}</text>
            <text class="close-btn" bindtap="handleCancel">×</text>
        </view>

        <scroll-view class="modal-body" scroll-y>
            <!-- 基本信息 -->
            <view class="form-section">
                <view class="section-title">基本信息</view>

                <view class="form-item">
                    <text class="form-label required">员工姓名</text>
                    <input class="form-input" type="text" placeholder="请输入员工姓名" value="{{formData.name}}"
                        bindinput="onInputChange" data-field="name" maxlength="10" disabled="{{formDisabled}}" />
                </view>
                <view class="form-item">
                    <text class="form-label required">身份证号</text>
                    <input class="form-input" type="text" placeholder="请输入身份证号" value="{{formData.sfzh}}"
                        bindinput="onInputChange" data-field="sfzh" maxlength="10" disabled="{{formDisabled}}" />
                </view>
                <view class="form-item">
                    <text class="form-label required">联系电话</text>
                    <input class="form-input" type="number" placeholder="请输入联系电话" value="{{formData.phone}}"
                        bindinput="onInputChange" data-field="phone" maxlength="11" disabled="{{formDisabled}}" />
                </view>
            </view>

            <!-- 工作信息 -->
            <view class="form-section">
                <view class="section-title">工作信息</view>
                <view class="form-item">
                    <text class="form-label required">工号</text>
                    <input class="form-input" type="text" placeholder="请输入员工工号" value="{{formData.employeeId}}"
                        bindinput="onInputChange" data-field="employeeId" maxlength="20" disabled="{{formDisabled}}" />
                </view>
                <view class="form-item">
                    <text class="form-label required">员工昵称</text>
                    <input class="form-input" type="text" placeholder="请输入员工昵称" value="{{formData.nickname}}"
                        bindinput="onInputChange" data-field="nickname" maxlength="10" disabled="{{formDisabled}}" />
                </view>
                <view class="form-item">
                    <text class="form-label required">职位</text>
                    <picker mode="selector" range="{{positionOptions}}" value="{{formData.position}}"
                        bindchange="onPositionChange" class="picker-input" disabled="{{formDisabled}}" >
                        <view class="picker-text {{formData.position ? '' : 'placeholder'}}">
                            {{formData.position || '请选择职位'}}
                        </view>
                    </picker>
                </view>

                <view class="form-item">
                    <text class="form-label required">所在店名</text>
                    <picker mode="selector" range="{{storeOptions}}" value="{{formData.storeName}}"
                        bindchange="onStoreChange" class="picker-input" disabled="{{formDisabled}}" >
                        <view class="picker-text {{formData.storeName ? '' : 'placeholder'}}">
                            {{formData.storeName || '请选择店名'}}
                        </view>
                    </picker>
                </view>

                <view class="form-item">
                    <text class="form-label required">入职日期</text>
                    <picker mode="date" value="{{formData.joinDate}}" bindchange="onJoinDateChange"
                        class="picker-input" disabled="{{formDisabled}}" >
                        <view class="picker-text {{formData.joinDate ? '' : 'placeholder'}}">
                            {{formData.joinDate || '请选择入职日期'}}
                        </view>
                    </picker>
                </view>

                <view class="form-item">
                    <text class="form-label required">在职状态</text>
                    <view class="status-options">
                        <view class="status-option {{formData.status === '在职' ? 'active' : ''}}" bindtap="setStatus"
                            data-status="在职">
                            <text class="status-dot"></text>
                            <text class="status-text">在职</text>
                        </view>
                        <view class="status-option {{formData.status === '离职' ? 'active' : ''}}" bindtap="setStatus"
                            data-status="离职">
                            <text class="status-dot"></text>
                            <text class="status-text">离职</text>
                        </view>
                    </view>
                </view>
            </view>

            <!-- 备注信息 -->
            <view class="form-section">
                <view class="section-title">备注信息</view>
                <view class="form-item">
                    <text class="form-label">员工备注</text>
                    <textarea class="form-textarea" placeholder="请输入备注信息（最多200字）" value="{{formData.notes}}" 
                    bindinput="onTextareaChange" data-field="notes" maxlength="200" disabled="{{formDisabled}}" />
                    <view class="textarea-counter">
                        <text>{{formData.notes ? formData.notes.length : 0}}/200</text>
                    </view>
                </view>
            </view>
        </scroll-view>

        <!-- 底部按钮 -->
        <view class="modal-footer" wx:if="{{!isView}}">
            <button class="btn-cancel" bindtap="handleCancel">取消</button>
            <button class="btn-confirm" bindtap="handleConfirm" disabled="{{!isFormValid}}">确认保存</button>
        </view>
         <!-- 查看模式下的关闭按钮（可选） -->
         <view class="modal-footer" wx:if="{{isView}}">
            <button class="btn-cancel" bindtap="handleCancel">关闭</button>
        </view>
    </view>
</view>