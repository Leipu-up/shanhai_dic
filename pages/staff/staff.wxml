<view class="staff-page">
  <!-- æœç´¢æ¡† -->
  <view class="search-bar">
    <view class="search-input-container">
      <text class="search-icon">ğŸ”</text>
      <input 
        class="search-input" 
        placeholder="è¾“å…¥å‘˜å·¥å§“åæœç´¢" 
        placeholder-style="color: #999;"
        value="{{searchKeyword}}"
        bindinput="onSearchInput"
        bindconfirm="onSearchConfirm"
      />
      <view class="search-clear" wx:if="{{searchKeyword}}" bindtap="clearSearch">
        <text>Ã—</text>
      </view>
    </view>
  </view>

  <!-- å‘˜å·¥åˆ—è¡¨ -->
  <view class="staff-list">
    <view wx:if="{{staffList.length > 0}}">
      <!-- ç»Ÿè®¡ä¿¡æ¯ -->
      <view class="stats-info">
        <view class="stats-item">
          <text class="stats-number">{{totalCount}}</text>
          <text class="stats-label">å‘˜å·¥æ€»æ•°</text>
        </view>
        <view class="stats-item">
          <text class="stats-number">{{onDutyCount}}</text>
          <text class="stats-label">åœ¨èŒå‘˜å·¥</text>
        </view>
        <view class="stats-item">
          <text class="stats-number">{{totalPages}}</text>
          <text class="stats-label">æ€»é¡µæ•°</text>
        </view>
      </view>

      <!-- å‘˜å·¥å¡ç‰‡åˆ—è¡¨ -->
      <view class="staff-grid">
        <view class="staff-card" 
              wx:for="{{staffList}}" 
              wx:key="id" 
              bindtap="viewStaffDetail"
              data-id="{{item.id}}">
          
          <!-- å‘˜å·¥å¤´åƒå’ŒåŸºæœ¬ä¿¡æ¯ -->
          <view class="card-header">
            <image class="staff-avatar" src="{{item.avatar || '/images/default-avatar.png'}}"></image>
            <view class="staff-basic-info">
              <text class="staff-name">{{item.name}}</text>
              <view class="staff-position">
                <text class="position-tag">{{item.position}}</text>
                <text class="store-tag">{{item.storeName}}</text>
              </view>
            </view>
          </view>

          <!-- å·¥å·å’Œç”µè¯ -->
          <view class="card-info-row">
            <view class="info-item">
              <text class="info-icon">ğŸ†”</text>
              <text class="info-text">{{item.employeeId}}</text>
            </view>
            <view class="info-item">
              <text class="info-icon">ğŸ“±</text>
              <text class="info-text">{{item.phone}}</text>
            </view>
          </view>

          <!-- åœ¨èŒçŠ¶æ€å’Œæ—¶é•¿ -->
          <view class="card-info-row">
            <view class="status-badge {{item.status === 'åœ¨èŒ' ? 'on-duty' : 'off-duty'}}">
              <text>{{item.status}}</text>
              <text class="duration-text" wx:if="{{item.workDuration}}">{{item.workDuration}}</text>
            </view>
          </view>

          <!-- æœ¬æœˆä¸šç»© -->
          <view class="performance-section">
            <view class="performance-label">
              <text class="performance-icon">ğŸ’°</text>
              <text class="performance-title">æœ¬æœˆä¸šç»©</text>
            </view>
            <text class="performance-amount">{{item.monthlyPerformance}}</text>
          </view>

          <!-- æ“ä½œæŒ‰é’® -->
          <view class="card-actions">
            <button class="action-btn call" size="mini" bindtap="callStaff" data-phone="{{item.phone}}" catchtap="stopPropagation">
              <text class="action-icon">ğŸ“</text>
              è”ç³»
            </button>
            <button class="action-btn edit" size="mini" bindtap="editStaff" data-id="{{item.id}}" catchtap="stopPropagation">
              <text class="action-icon">âœï¸</text>
              ç¼–è¾‘
            </button>
          </view>
        </view>
      </view>

      <!-- åˆ†é¡µåŠ è½½æç¤º -->
      <view class="load-more-container">
        <view wx:if="{{isLoading}}" class="loading-more">
          <view class="loading-spinner"></view>
          <text class="loading-text">æ­£åœ¨åŠ è½½æ›´å¤š...</text>
        </view>
        
        <view wx:if="{{!hasMore && totalCount > 0}}" class="no-more-data">
          <text class="no-more-text">å·²åŠ è½½å…¨éƒ¨å‘˜å·¥</text>
        </view>
        
        <view wx:if="{{hasMore && !isLoading}}" class="load-more-tip">
          <text class="load-more-text">ä¸Šæ‹‰åŠ è½½æ›´å¤š</text>
        </view>
      </view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view wx:else class="empty-state">
      <view class="empty-icon">ğŸ‘©â€ğŸ’¼</view>
      <text class="empty-text" wx:if="{{searchKeyword}}">æœªæ‰¾åˆ°åŒ¹é…çš„å‘˜å·¥</text>
      <text class="empty-text" wx:else>æš‚æ— å‘˜å·¥ä¿¡æ¯</text>
      <button class="btn-primary" bindtap="showAddModal">æ–°å¢å‘˜å·¥</button>
    </view>
  </view>

  <!-- æ–°å¢å‘˜å·¥æŒ‰é’® -->
  <view class="add-btn-container" wx:if="{{staffList.length > 0}}">
    <button class="add-btn" bindtap="showAddModal">
      <text class="add-icon">+</text>
      <text class="add-text">æ–°å¢å‘˜å·¥</text>
    </button>
  </view>

  <!-- æ–°å¢å‘˜å·¥å¼¹çª—ç»„ä»¶ -->
  <add-staff-modal 
    id="addStaffModal"
    bind:confirm="handleAddStaff"
    bind:cancel="hideAddModal"
  />
</view>